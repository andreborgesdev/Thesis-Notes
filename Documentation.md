# Documentation

When consuming a Web API, understanding its various methods can be challenging for a developer. Swagger, also known as OpenAPI, solves the problem of generating useful documentation and help pages for Web APIs. It provides benefits such as interactive documentation, client SDK generation, and API discoverability.

## What is Swagger / OpenAPI?

Swagger is a language-agnostic specification for describing REST APIs. The Swagger project was donated to the OpenAPI Initiative, where it's now referred to as OpenAPI. Both names are used interchangeably; however, OpenAPI is preferred. It allows both computers and humans to understand the capabilities of a service without any direct access to the implementation (source code, network access, documentation). One goal is to minimize the amount of work needed to connect disassociated services. Another goal is to reduce the amount of time needed to accurately document a service.

## Swagger specification (swagger.json)

The core to the Swagger flow is the Swagger specification—by default, a document named swagger.json. It's generated by the Swagger tool chain (or third-party implementations of it) based on your service. It describes the capabilities of your API and how to access it with HTTP. It drives the Swagger UI and is used by the tool chain to enable discovery and client code generation.

## Swagger UI

Swagger UI offers a web-based UI that provides information about the service, using the generated Swagger specification. Both Swashbuckle and NSwag include an embedded version of Swagger UI, so that it can be hosted in your ASP.NET Core app using a middleware registration call.

Each public action method in your controllers can be tested from the UI. Click a method name to expand the section. Add any necessary parameters, and click Try it out!.

<https://docs.microsoft.com/en-us/aspnet/core/tutorials/web-api-help-pages-using-swagger?view=aspnetcore-3.0>

## Swashbuckle vs NSwag

They are similar.

The big selling point of NSwag is its ability to not only introduce the Swagger UI, but generate complete, robust and efficient API client code for C# and TypeScript. You also have the choice to use it directly in code, with an easy to use GUI or in cmd. It also supports asp.net core. All in all the workflow offers more than Swashbuckle

NSwag not only provides the functionality of Swashbuckle (Swagger generation) but also code generators. This way we can avoid incompatibilities and offer more features and a more streamlined toolchain.

NSwag offers the following capabilities:

- The ability to utilize the Swagger UI and Swagger generator.
- Flexible code generation capabilities.

It automatically fills the documentation more precisely and robusticly and has less errors. Swashsbuckles need a library to read the inheritdoc (specify what does are for), otherwise he does not recognise them and some fields appear blank.

## Swashbuckle

There are three main components to Swashbuckle:

- Swashbuckle.AspNetCore.Swagger: a Swagger object model and middleware to expose SwaggerDocument objects as JSON endpoints.

- Swashbuckle.AspNetCore.SwaggerGen: a Swagger generator that builds SwaggerDocument objects directly from your routes, controllers, and models. It's typically combined with the Swagger endpoint middleware to automatically expose Swagger JSON.

- Swashbuckle.AspNetCore.SwaggerUI: an embedded version of the Swagger UI tool. It interprets Swagger JSON to build a rich, customizable experience for describing the web API functionality. It includes built-in test harnesses for the public methods.

<https://docs.microsoft.com/en-us/aspnet/core/tutorials/getting-started-with-swashbuckle?view=aspnetcore-3.0&tabs=visual-studio>

Adding triple-slash comments to an action enhances the Swagger UI by adding the description to the section header.

Add a <remarks> element to the Create action method documentation. It supplements information specified in the <summary> element and provides a more robust Swagger UI. The <remarks> element content can consist of text, JSON, or XML.

Decorate the model with attributes, found in the System.ComponentModel.DataAnnotations namespace, to help drive the Swagger UI components.

Add the [Produces("application/json")] attribute to the API controller. Its purpose is to declare that the controller's actions support a response content type of application/json.

Developers consuming a web API are most concerned with what's returned—specifically response types and error codes (if not standard). The response types and error codes are denoted in the XML comments and data annotations.

In ASP.NET Core 2.2 or later, conventions can be used as an alternative to explicitly decorating individual actions with [ProducesResponseType].

## InheritDoc

There is a bug that compiles the comments and does not replace <inheritdoc/> tag with the correpondent comment.

InheritDoc Nugget allows to overwrite the compiled file and to replace it, however for swagger to interpert it this overwrite operation has to be made when compiling.

- SDK Bug - the comments for the Interface methods are being generated on the Protected Methods region instead of the Pulblic Methods region, this is why our controller can not inherit the comments from the interface and they do not appear on the swagger documentation.

<https://github.com/domaindrivendev/Swashbuckle/issues/1000>
<https://github.com/dotnet/csharplang/issues/313>

1. dotnet tool -g install InheritDoc
2. Add this target to your csproj file and also

```csharp
<Target Name="InheritDoc" AfterTargets="PostBuildEvent" Condition="$(GenerateDocumentationFile)">
    <Exec Command="InheritDoc -o" IgnoreExitCode="True" ContinueOnError="true"/>
</Target>
```

NSwag does it natively.

<https://github.com/RicoSuter/NSwag/wiki/NSwag-Configuration-Document>

JWT for authentication - RCF7XXXX - jwt.io

Primavera uses the Identity server to generate client secrets for the apps, then those apps with the client secret generate the token to make requests to the API

<https://github.com/RicoSuter/NSwag/wiki/AspNetCore-Middlewar

## Control Version of the documentation

Environment SANDBOX for controlled API tests.
